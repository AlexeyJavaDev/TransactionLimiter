The microservice accepts transactions from the bank in rubles, processes them and saves them in its database.
The user can set a spending limit in dollars for two categories (service or product).
The microservice recalculates the transaction amount at the current rate and flags the transaction if it exceeds the limit.
Exchange rates are stored in the database, because requests to the resource are paid, the rate is updated according to the New York opening and closing times of trading, twice a day.
The database stores all the set limits, the user can request a list of limits with the dates of exposure or current limits by category.
The user can request a list of transactions that have exceeded the limit, indicating the limits and dates of issue.

Микросервис принимает транзакции от банка в рублях, обрабатывает их и сохраняет в своей базе данных.
Пользователь может установить лимит расхода средств в долларах по двум категориям(сервис или продукт).
Микросервис пересчитывает сумму транзакции по текущему курсу и помечает транзакцию, если она превышает лимит.
Курсы валют хранятся в базе, т.к. запросы к ресурсу платные, курс обновляется по Нью-Йорксому времени открытия и закрытия торгов, дважды в сутки.
В базе данных хранятся все установленные лимиты, пользователь может запросить список лимитов с датами выставления или актуальные лимиты по категориям.
Пользователь может запросить список превысивших лимит транзакций с указаниями лимитов и дат выставления.

CREATE TABLE limits
(
id BIGINT PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
setting_date TIMESTAMP WITH TIME ZONE,
account VARCHAR(10),
category VARCHAR(10),
limit_sum DOUBLE PRECISION,
limit_balance DOUBLE PRECISION,
balance_month integer
);

CREATE TABLE transactions
(
id BIGINT PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
account_from VARCHAR(10),
account_to VARCHAR(10),
currency_shortname VARCHAR(3),
transaction_sum DOUBLE PRECISION,
expense_category VARCHAR(10),
datetime TIMESTAMP WITH TIME ZONE,
limit_exceeded BOOLEAN,
limit_id BIGINT REFERENCES limits (id)
);
CREATE TABLE currency_price
(
datetime TIMESTAMP PRIMARY KEY,
price DOUBLE PRECISION
)

Incoming transaction
POST REQUEST:
/api/bank/v1/transactions
{
"accountFromId":"0000000001",
"accountToId": "0000000002",
"transactionCurrency": "RUB",
"transactionSum": 502.45,
"expenseCategory": "product",
"transactionDate": "2023-02-21T09:48:00.860+00:00"
}

Set limit
POST REQUEST:
/api/user/v1/limits
{
"account": "0000000001",
"category": "product",
"limitSum": 1000.0
}

Get all limits by account
GET REQUEST
/api/user/v1/limits/{account}

Get actual limit for some category / all categories by account
GET REQUEST:
/api/user/v1/limits/{account}/actual?category=product/service/all

Get all limit exceeded transactions by account
GET REQUEST:
/api/user/v1/transactions/{account}